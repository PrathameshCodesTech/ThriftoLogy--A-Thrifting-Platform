{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/clothesGallery.css' %}">
{% endblock %}

{% block title %}Thriftology - Bottom{% endblock %}

{% block herosection %}
<!-- Main Content -->
<main class="pt-32 max-w-7xl mx-auto px-4">
    <h1 class="collection-title text-3xl font-bold mb-8">Bottom Collection</h1>
    
    <!-- Search Form -->
    <form method="GET" class="search-container mb-8" id="searchForm">
        <input type="text" 
               name="query" 
               class="search-input border px-4 py-2 rounded-full w-full md:w-1/2" 
               placeholder="Search Bottom..." 
               value="{{ query|default:'' }}">
        <!-- Preserve other parameters -->
        <input type="hidden" name="brand" value="{{ selected_brand }}">
        <input type="hidden" name="sort_by" value="{{ selected_sort }}">
        <button type="submit" class="search-button bg-black text-white px-4 py-2 rounded-full ml-2 hover:bg-gray-800 transition-colors duration-200">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
        </button>
    </form>
    
    <!-- Filters Section -->
    <div class="mb-8 flex flex-col md:flex-row justify-between items-center">
        <!-- Brand Filters -->
        <div class="space-x-4 mb-4 md:mb-0">
            <a href="?{% if query %}query={{ query }}&{% endif %}{% if selected_sort %}sort_by={{ selected_sort }}{% endif %}" 
               class="{% if not selected_brand %}bg-black text-white{% else %}bg-gray-100 text-gray-800{% endif %} px-6 py-2 rounded-full hover:bg-gray-800 hover:text-white transition-colors duration-200">
                All
            </a>
            {% for brand in brands %}
            <a href="?brand={{ brand }}{% if query %}&query={{ query }}{% endif %}{% if selected_sort %}&sort_by={{ selected_sort }}{% endif %}" 
               class="{% if selected_brand == brand %}bg-black text-white{% else %}bg-gray-100 text-gray-800{% endif %} px-6 py-2 rounded-full hover:bg-gray-800 hover:text-white transition-colors duration-200">
                {{ brand }}
            </a>
            {% endfor %}
        </div>
        
        <!-- Sort Form -->
        <form method="GET" class="flex items-center" id="sortForm">
            <input type="hidden" name="query" value="{{ query }}">
            <input type="hidden" name="brand" value="{{ selected_brand }}">
            <select name="sort_by" 
                    class="border px-4 py-2 rounded-full focus:outline-none focus:border-black cursor-pointer hover:border-gray-400 transition-colors duration-200" 
                    onchange="this.form.submit()">
                <option value="newest" {% if selected_sort == 'newest' or not selected_sort %}selected{% endif %}>Sort by: Newest</option>
                <option value="low_to_high" {% if selected_sort == 'low_to_high' %}selected{% endif %}>Price: Low to High</option>
                <option value="high_to_low" {% if selected_sort == 'high_to_low' %}selected{% endif %}>Price: High to Low</option>
            </select>
        </form>
    </div>
{% endblock %}

{% block product-grid %}
<section id="product-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4">
    {% if products %}
        {% for product in products %}
        <div class="border p-4 rounded-lg hover:shadow-lg transition-shadow duration-200">
            <div class="video-container relative overflow-hidden">
                <a href="{% url 'Detail' pk=product.id %}" class="block">
                    <img src="{{ product.image.url }}" 
                         alt="{{ product.description }}"
                         class="w-full h-auto transition-transform duration-200 hover:scale-105">
                </a>
                {% if product.video %}
                <video class="hidden absolute top-0 left-0 w-full h-full object-cover" 
                       src="{{ product.video.url }}" 
                       loop muted></video>
                {% endif %}
            </div>
            <h2 class="text-lg font-bold my-2 truncate">{{ product.name }}</h2>
            <p class="text-sm text-gray-600">{{ product.era }}</p>
            <p class="text-sm text-gray-600">{{ product.material }}</p>
            <p class="text-red-500 font-bold">₹ {{ product.selling_price }}</p>
            <p class="text-gray-500 line-through">₹ {{ product.discounted_price }}</p>
            <br>
            <a href="{% url 'Detail' pk=product.id %}">
                <button class="w-full bg-black text-white px-4 py-2 rounded hover:bg-gray-800 transition-colors duration-200">
                    View More
                </button>
            </a>
        </div>
        {% endfor %}
    {% else %}
        <div class="col-span-full text-center py-8">
            <p class="text-gray-500 text-lg">No products found matching your criteria.</p>
        </div>
    {% endif %}
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/clothesGallery.js' %}"></script>
{% endblock %}